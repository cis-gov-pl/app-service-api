<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CISAppServer Package &mdash; CIŚ Web Services 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/cistheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="CIŚ Web Services 0.2 documentation" href="index.html" />
    <link rel="up" title="Implementation reference" href="modules.html" />
    <link rel="prev" title="CISAppGateway Package" href="CISAppGateway.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CISAppGateway.html" title="CISAppGateway Package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">CIŚ Web Services 0.2 documentation</a> &raquo;</li>
          <li><a href="modules.html" accesskey="U">Implementation reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="webapi.html">Web API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Implementation reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="modules.html#source-code">Source Code</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="modules.html#class-reference">Class reference</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="CISAppGateway.html"
                        title="previous chapter">CISAppGateway Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/CISAppServer.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="cisappserver-package">
<h1>CISAppServer Package<a class="headerlink" href="#cisappserver-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-CISAppServer.JobManager">
<span id="jobmanager-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">JobManager</span></tt> Module<a class="headerlink" href="#module-CISAppServer.JobManager" title="Permalink to this headline">¶</a></h2>
<p>Main module of CISAppServer. Responsible for job management.</p>
<dl class="class">
<dt id="CISAppServer.JobManager.Job">
<em class="property">class </em><tt class="descclassname">CISAppServer.JobManager.</tt><tt class="descname">Job</tt><big>(</big><em>job_id</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Class that implements a job instance.</p>
<p>Allows to:</p>
<ul class="simple">
<li>query/set job state,</li>
<li>generate the output status file,</li>
<li>query job parameters defined in job request.</li>
</ul>
<p>Works with existing job requests that are identified by their unique ID
string. Upon initialization loads job parameters from job request JSON
file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job_id</strong> &#8211; The unique job ID.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="CISAppServer.JobManager.Job.calculate_size">
<tt class="descname">calculate_size</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.calculate_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate size of output directory of the job if it exists.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.Job.compact">
<tt class="descname">compact</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.compact" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.JobManager.Job.data">
<tt class="descname">data</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.JobManager.Job.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Job parameters as specified in job request.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.Job.die">
<tt class="descname">die</tt><big>(</big><em>message</em>, <em>err=True</em>, <em>exc_info=False</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.die" title="Permalink to this definition">¶</a></dt>
<dd><p>Abort further job execution with proper error in AppServer log as well
as with proper message for clinet in the job output status file. Sets
job state as <em>aborted</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; Message to be passed to logs and client,</li>
<li><strong>err</strong> &#8211; if True use log as ERROR otherwise use WARNING priority,</li>
<li><strong>exc_info</strong> &#8211; if True logging will extract current exception info
(use in except block to provide additional information to the
logger).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.Job.exit">
<tt class="descname">exit</tt><big>(</big><em>message</em>, <em>state='done'</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one of job finished states and generate job output status file.</p>
<p>The output file is created on the shared storage so that the AppGateway
can pass the job status and the message to clients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; Message that will be written to the output status file.</li>
<li><strong>state</strong> &#8211; Job state to set. Valid values are &#8216;done&#8217;, aborted&#8217;,
&#8216;killed&#8217;</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.Job.get_size">
<tt class="descname">get_size</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of job output directory.
Requires that calculate_size was called first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Size of output directory in bytes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.Job.get_state">
<tt class="descname">get_state</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.get_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get current job state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">One of valid job states:</td>
</tr>
</tbody>
</table>
<ul>
<li><dl class="first docutils">
<dt>waiting:</dt>
<dd><p class="first last">job request was submitted and is waiting for JobManager to process
it,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>queued:</dt>
<dd><p class="first last">job reuest was processed and is queued in the scheduling backend,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>running:</dt>
<dd><p class="first last">job is running on a compute node,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>done:</dt>
<dd><p class="first last">job has finished,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>aborted:</dt>
<dd><p class="first last">an error occurred during job preprocessing, submission or
postprocessing,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>killed:</dt>
<dd><p class="first last">job execution was stopped by an user,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>delete:</dt>
<dd><p class="first last">job is scheduled for removal</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.JobManager.Job.id">
<tt class="descname">id</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.JobManager.Job.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique job ID string.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.JobManager.Job.service">
<tt class="descname">service</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.JobManager.Job.service" title="Permalink to this definition">¶</a></dt>
<dd><p>Jobs&#8217; Service</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.Job.set_state">
<tt class="descname">set_state</tt><big>(</big><em>new_state</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.Job.set_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Change job state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_state</strong> &#8211; new sate for the job. For valid states see
<a class="reference internal" href="#CISAppServer.JobManager.Job.get_state" title="CISAppServer.JobManager.Job.get_state"><tt class="xref py py-meth docutils literal"><span class="pre">get_state()</span></tt></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.JobManager.Job.valid_data">
<tt class="descname">valid_data</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.JobManager.Job.valid_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Job parameters after validation</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.JobManager.JobManager">
<em class="property">class </em><tt class="descclassname">CISAppServer.JobManager.</tt><tt class="descname">JobManager</tt><a class="headerlink" href="#CISAppServer.JobManager.JobManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Main calss of CISAppServer. It is responsible for job management.</p>
<p>Upon initialization stes up Validator and Sheduler interfaces.</p>
<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_deleted_jobs">
<tt class="descname">check_deleted_jobs</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_deleted_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for jobs marked for removal.</p>
<p>If found remove all resources related to the job. If a job is still
running kill it.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_new_jobs">
<tt class="descname">check_new_jobs</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_new_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for new job files in the queue directory.</p>
<p>If found try to submit them to selected job scheduler.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_old_jobs">
<tt class="descname">check_old_jobs</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_old_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for jobs that exceed their life time.</p>
<p>If found mark them for removal.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_running_jobs">
<tt class="descname">check_running_jobs</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_running_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check status of running jobs.</p>
<p>If finished jobs are found perform finalisation.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.collect_garbage">
<tt class="descname">collect_garbage</tt><big>(</big><em>service</em>, <em>full=False</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.collect_garbage" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if service quota is not exceeded. If yes remove oldest finished
jobs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>service</strong> &#8211; Service name for which garbage collection should be
performed,</li>
<li><strong>delta</strong> &#8211; Perform the quota check as if current disk usage was
increased by delta MBs.</li>
<li><strong>full</strong> &#8211; If True force garbage collection even if disk usage is
not above alloted quota. In addition removes all jobs older than
min job life time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if quota is not reached or garbage collection succeeded.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.get_job">
<tt class="descname">get_job</tt><big>(</big><em>job_id</em>, <em>create=False</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.get_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Job object from internal list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>job_id</strong> &#8211; Job unique ID,</li>
<li><strong>create</strong> &#8211; If job identified by <em>job_id</em> is not found in the list
an ERROR message is logged. When create is True a new Job object is
created and added to the list,</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Job object if <em>job_id</em> was found, None otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.init">
<tt class="descname">init</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize JobManager. Creates new instaces of Validator and
Schedulers. Loads existing jobs from file system.</p>
<p>Existing state is purged.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.run">
<tt class="descname">run</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of JobManager.</p>
<ul class="simple">
<li>Check for new jobs - submit them if found,</li>
<li>Check for finished jobs - retrive output if found,</li>
<li>Check for jobs exceeding their life time - mark for removal,</li>
<li>Check for jobs to be removed - delete all related resources.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.shutdown">
<tt class="descname">shutdown</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.shutdown" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.start">
<tt class="descname">start</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.stop">
<tt class="descname">stop</tt><big>(</big><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.submit">
<tt class="descname">submit</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.JobManager.JobManager.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate job related scripts and submit them to selected scheduler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; The Job object to submit.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success, False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CISAppServer.Tools">
<span id="tools-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">Tools</span></tt> Module<a class="headerlink" href="#module-CISAppServer.Tools" title="Permalink to this headline">¶</a></h2>
<p>Utility classes used by CISAppServer: validation, communication with queue
managers, etc.</p>
<dl class="class">
<dt id="CISAppServer.Tools.CTemplate">
<em class="property">class </em><tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">CTemplate</tt><big>(</big><em>template</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.CTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">string.Template</span></tt></p>
<p>Class used to substitute placeholder strings in script templates.
The placeholders have following form: &#64;&#64;{KEY}.</p>
<dl class="attribute">
<dt id="CISAppServer.Tools.CTemplate.delimiter">
<tt class="descname">delimiter</tt><em class="property"> = '&#64;&#64;'</em><a class="headerlink" href="#CISAppServer.Tools.CTemplate.delimiter" title="Permalink to this definition">¶</a></dt>
<dd><p>Delimiter identifying keywords.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.CTemplate.idpattern">
<tt class="descname">idpattern</tt><em class="property"> = '[_a-z0-9]+'</em><a class="headerlink" href="#CISAppServer.Tools.CTemplate.idpattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.CTemplate.pattern">
<tt class="descname">pattern</tt><em class="property"> = &lt;_sre.SRE_Pattern object at 0x36696f0&gt;</em><a class="headerlink" href="#CISAppServer.Tools.CTemplate.pattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Tools.PbsScheduler">
<em class="property">class </em><tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">PbsScheduler</tt><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CISAppServer.Tools.Scheduler" title="CISAppServer.Tools.Scheduler"><tt class="xref py py-class docutils literal"><span class="pre">CISAppServer.Tools.Scheduler</span></tt></a></p>
<p>Class implementing simple interface for PBS queue system.</p>
<p>Allows for job submission, deletion and extraction of job status.</p>
<dl class="attribute">
<dt id="CISAppServer.Tools.PbsScheduler.default_queue">
<tt class="descname">default_queue</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Default PBS queue</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.PbsScheduler.finalise">
<tt class="descname">finalise</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.finalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare output of finished job.</p>
<p>Job working directory is moved to the external_data_path directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.PbsScheduler.max_jobs">
<tt class="descname">max_jobs</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.PbsScheduler.queue_path">
<tt class="descname">queue_path</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.queue_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where submitted PBS job IDs are stored</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.PbsScheduler.status">
<tt class="descname">status</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Return status of the job in PBS queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
</tbody>
</table>
<p>Returns one of &#8220;waiting&#8221;, &#8220;running&#8221;, &#8220;done&#8221;, &#8220;unknown&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.PbsScheduler.stop">
<tt class="descname">stop</tt><big>(</big><em>job</em>, <em>msg</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop running job and remove it from PBS queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</li>
<li><strong>msg</strong> &#8211; Message that will be passed to the user</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True on success and False otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.PbsScheduler.submit">
<tt class="descname">submit</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a job to PBS queue. The &#8220;pbs.sh&#8221; script should be already
present in the pbs_work_path/job directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.PbsScheduler.work_path">
<tt class="descname">work_path</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.PbsScheduler.work_path" title="Permalink to this definition">¶</a></dt>
<dd><p>PBS Working directory path</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Tools.Scheduler">
<em class="property">class </em><tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">Scheduler</tt><a class="headerlink" href="#CISAppServer.Tools.Scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Virtual Class implementing simple interface for execution backend. Actual
execution backends should derive from this class and implement defined
interface.</p>
<p>Allows for job submission, deletion and extraction of job status.</p>
<dl class="attribute">
<dt id="CISAppServer.Tools.Scheduler.default_queue">
<tt class="descname">default_queue</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Scheduler.default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Default queue</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Scheduler.finalise">
<tt class="descname">finalise</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Scheduler.finalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare output of finished job.</p>
<p>Job working directory is moved to the output_path directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Scheduler.generate_scripts">
<tt class="descname">generate_scripts</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Scheduler.generate_scripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate scripts and job input files from templates.</p>
<p>Will walk through service_data_path/service and copy all files
including recursion through subdirectories to PBS work directory for
specified job (the directory structure is retained). For all files
substitute all occurences of &#64;&#64;{atribute_name} with specified values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance after validation</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Scheduler.max_jobs">
<tt class="descname">max_jobs</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Scheduler.max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Scheduler.queue_path">
<tt class="descname">queue_path</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Scheduler.queue_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where submitted job IDs are stored</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Scheduler.status">
<tt class="descname">status</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Scheduler.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Return status of the job in execution queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
</tbody>
</table>
<p>Returns one of &#8220;waiting&#8221;, &#8220;running&#8221;, &#8220;done&#8221;, &#8220;unknown&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Scheduler.stop">
<tt class="descname">stop</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Scheduler.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop running job and remove it from execution queue.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Scheduler.submit">
<tt class="descname">submit</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Scheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a job for execution. The &#8220;pbs.sh&#8221; script should be already
present in the work_path/job directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Scheduler.work_path">
<tt class="descname">work_path</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Scheduler.work_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Working directory path</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Tools.Service">
<em class="property">class </em><tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">Service</tt><big>(</big><em>data</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Service" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></p>
<p>Class implementing a Service.</p>
<p>Stores Service configuration and monitors its state.</p>
<dl class="method">
<dt id="CISAppServer.Tools.Service.add_job_proxy">
<tt class="descname">add_job_proxy</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Service.add_job_proxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Service.config">
<tt class="descname">config</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Service.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration options affecting service handling - like allowed
diskspace and garbage collection</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Service.current_size">
<tt class="descname">current_size</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Service.current_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Projection of space usage by service output files</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Service.real_size">
<tt class="descname">real_size</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Service.real_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Real space usage by service output files</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Service.remove_job">
<tt class="descname">remove_job</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Service.remove_job" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Service.remove_job_proxy">
<tt class="descname">remove_job_proxy</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Service.remove_job_proxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Service.sets">
<tt class="descname">sets</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Service.sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Definitions of allowed variable sets</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Service.update_job">
<tt class="descname">update_job</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Service.update_job" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Tools.Service.variables">
<tt class="descname">variables</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Service.variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Definitions of allowed variables</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Tools.Validator">
<em class="property">class </em><tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">Validator</tt><a class="headerlink" href="#CISAppServer.Tools.Validator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Class responsible for validation of job input data.
It is also responsible for preparation of PBS scripts.</p>
<p>Upon initialisation load services configuration.</p>
<dl class="attribute">
<dt id="CISAppServer.Tools.Validator.services">
<tt class="descname">services</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Tools.Validator.services" title="Permalink to this definition">¶</a></dt>
<dd><p>Services configurations</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Validator.validate">
<tt class="descname">validate</tt><big>(</big><em>job</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Validator.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate job input data and update <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance with
validated data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">Job</span></tt> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Rerurn :</th><td class="field-body">True on success False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Tools.Validator.validate_value">
<tt class="descname">validate_value</tt><big>(</big><em>key</em>, <em>value</em>, <em>service</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.Validator.validate_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate value for specified service attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> &#8211; attribute name</li>
<li><strong>value</strong> &#8211; value to validate</li>
<li><strong>service</strong> &#8211; service object for which attribute is defined</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True on success False otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="CISAppServer.Tools.rmtree_error">
<tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">rmtree_error</tt><big>(</big><em>function</em>, <em>path</em>, <em>exc_info</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.rmtree_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception handler for shutil.rmtree().</p>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.Tools.verbose">
<tt class="descclassname">CISAppServer.Tools.</tt><tt class="descname">verbose</tt><big>(</big><em>msg</em>, <em>exc_info=False</em><big>)</big><a class="headerlink" href="#CISAppServer.Tools.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>Log message with VERBOSE log level.</p>
<p>VERBOSE log level is higher than DEBUG and should be used for large debug
messages, e.g. data dumps, output from subprocesses, etc.</p>
</dd></dl>

</div>
<div class="section" id="module-CISAppServer.Config">
<span id="config-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">Config</span></tt> Module<a class="headerlink" href="#module-CISAppServer.Config" title="Permalink to this headline">¶</a></h2>
<p>Global configuration for CISAppServer.</p>
<dl class="class">
<dt id="CISAppServer.Config.Config">
<em class="property">class </em><tt class="descclassname">CISAppServer.Config.</tt><tt class="descname">Config</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#CISAppServer.Config.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></p>
<p>Class responsible for configuration storage and initialization.</p>
<p>Config stores variables as instace members e.g.:</p>
<blockquote>
<div>conf.config_file</div></blockquote>
<p>The variables are also accessible via dictionary interface e.g.:</p>
<blockquote>
<div>conf[&#8216;conf_file&#8217;]</div></blockquote>
<p>Upon initialisation some default values are applied to the variables.
However to finish the initialization <a class="reference internal" href="#CISAppServer.Config.Config.load" title="CISAppServer.Config.Config.load"><tt class="xref py py-meth docutils literal"><span class="pre">Config.load()</span></tt></a> method
should be called.</p>
<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_file">
<tt class="descname">config_file</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Config file name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_progress_step">
<tt class="descname">config_progress_step</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_progress_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Every n-th status query dump the progress logs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_sleep_time">
<tt class="descname">config_sleep_time</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_sleep_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Sleep interval in seconds between job status queries</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_path_pidfile">
<tt class="descname">daemon_path_pidfile</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_path_pidfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Daemon mode pid file path</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_path_workdir">
<tt class="descname">daemon_path_workdir</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_path_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Working directory of daemon</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_pidfile_timeout">
<tt class="descname">daemon_pidfile_timeout</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_pidfile_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Timeout for daemon mode pid file acquisition</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path">
<tt class="descname">gate_path</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of job states with corresponding paths</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_aborted">
<tt class="descname">gate_path_aborted</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_aborted" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where aborted jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_delete">
<tt class="descname">gate_path_delete</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where jobs shceduled for removal are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_done">
<tt class="descname">gate_path_done</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_done" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where done jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_dump">
<tt class="descname">gate_path_dump</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs output is moved before removal (aleviates problems
with files that are still in use)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_exit">
<tt class="descname">gate_path_exit</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were jobs exit status is stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_failed">
<tt class="descname">gate_path_failed</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_failed" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where failed jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_jobs">
<tt class="descname">gate_path_jobs</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were jobs description is stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_killed">
<tt class="descname">gate_path_killed</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_killed" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where killed jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_output">
<tt class="descname">gate_path_output</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs output will be stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_queued">
<tt class="descname">gate_path_queued</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_queued" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where queued jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_running">
<tt class="descname">gate_path_running</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_running" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where running jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_shared">
<tt class="descname">gate_path_shared</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the shared storage used as communication medium with
AppGateway</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_waiting">
<tt class="descname">gate_path_waiting</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_waiting" title="Permalink to this definition">¶</a></dt>
<dd><p>Path were where waiting jobs are symlinked</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.Config.json_load">
<tt class="descname">json_load</tt><big>(</big><em>file</em><big>)</big><a class="headerlink" href="#CISAppServer.Config.Config.json_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a JSON file</p>
<p>First remove comments and then use the json module package
Comments look like</p>
<div class="highlight-python"><pre>    // ...
or
    /*
    ...
    */</pre>
</div>
<p>Based on:
<a class="reference external" href="http://www.lifl.fr/~riquetd/parse-a-json-file-with-comments.html">http://www.lifl.fr/~riquetd/parse-a-json-file-with-comments.html</a>.
Much faster than <a class="reference external" href="https://github.com/getify/JSON.minify">https://github.com/getify/JSON.minify</a> and
<a class="reference external" href="https://gist.github.com/WizKid/1170297">https://gist.github.com/WizKid/1170297</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> &#8211; name of the file to parse.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.Config.load">
<tt class="descname">load</tt><big>(</big><em>conf_name=None</em><big>)</big><a class="headerlink" href="#CISAppServer.Config.Config.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load CISAppServer configuration from JSON file and finalize the
initialisation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conf_name</strong> &#8211; name of CISAppServer config file. When <em>None</em> is
provided hardcoded defaults are used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_config">
<tt class="descname">log_config</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of logging module</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_level">
<tt class="descname">log_level</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging level</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_level_cli">
<tt class="descname">log_level_cli</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_level_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging level CLI override</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_output">
<tt class="descname">log_output</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Log output file name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_output_cli">
<tt class="descname">log_output_cli</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_output_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Log output file name CLI override</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.Config.mkdir_p">
<tt class="descname">mkdir_p</tt><big>(</big><em>path</em><big>)</big><a class="headerlink" href="#CISAppServer.Config.Config.mkdir_p" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_default_queue">
<tt class="descname">pbs_default_queue</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of default PBS queue</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_max_jobs">
<tt class="descname">pbs_max_jobs</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent PBS jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_path_queue">
<tt class="descname">pbs_path_queue</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_path_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where PBS backend will store job IDs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_path_work">
<tt class="descname">pbs_path_work</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_path_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where PBS backeng will create job working directories</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_job_size">
<tt class="descname">service_job_size</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_job_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Default expected output size of a job in MB. It is used to estimate
space requirements for jobs that are to be scheduled.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_jobs">
<tt class="descname">service_max_jobs</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Default maximum number of concurrent jobs allowed per dervice</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_lifetime">
<tt class="descname">service_max_lifetime</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Default job maximum lifetime in hours (supports fractions). Jobs
that are older then this will be removed by garbage collector.
Setting this to zero means jobs can be immortal (at least until
service quota is exceeded)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_runtime">
<tt class="descname">service_max_runtime</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_runtime" title="Permalink to this definition">¶</a></dt>
<dd><p>Default job maximum running time in hours (supports fractions). Jobs
that are in running state longer then this will be killed and
removed by garbage collector.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_min_lifetime">
<tt class="descname">service_min_lifetime</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_min_lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Default job minimum lifetime in hours (supports fractions). Jobs
that are younger then this cannot be removed by garbage collector</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_path_conf">
<tt class="descname">service_path_conf</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_path_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Path with services configuration files</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_path_data">
<tt class="descname">service_path_data</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_path_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Path with services scripts and input files</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_quota">
<tt class="descname">service_quota</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_quota" title="Permalink to this definition">¶</a></dt>
<dd><p>Defaul maximum disk size used by service output files in MB</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_reserved_keys">
<tt class="descname">service_reserved_keys</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_reserved_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Reserved key names for job parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_states">
<tt class="descname">service_states</tt><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid job states as well as names of directories on shared storage
that are used to monitor job states</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="CISAppServer.Config.conf">
<tt class="descclassname">CISAppServer.Config.</tt><tt class="descname">conf</tt><em class="property"> = {'pbs_path_work': 'PBS/Scratch', 'gate_path_dump': 'Dump', 'service_max_jobs': 80, 'service_max_runtime': 12, 'daemon_pidfile_timeout': -1, 'gate_path_running': None, 'log_config': {'handlers': {'mail': {'toaddrs': 'konrad.klimaszewski&#64;gazeta.pl', 'level': 'ERROR', 'fromaddr': 'kklimaszewski&#64;cis.gov.pl', 'mailhost': 'localhost', 'formatter': 'verbose', 'class': 'logging.handlers.SMTPHandler', 'subject': 'AppServer Error'}, 'console': {'formatter': 'simple', 'class': 'logging.StreamHandler', 'level': 'INFO'}, 'file': {'backupCount': 5, 'level': 'INFO', 'filename': '/tmp/CISAppServer.log', 'formatter': 'verbose', 'class': 'logging.handlers.RotatingFileHandler', 'maxBytes': 10000000}}, 'version': 1, 'root': {'level': 'INFO', 'handlers': ['console', 'file', 'mail']}, 'disable_existing_loggers': False, 'formatters': {'simple': {'format': '%(levelname)s %(message)s'}, 'verbose': {'datefmt': '%m-%d %H:%M:%S', 'format': '%(levelname)s %(asctime)s %(module)s : %(message)s'}}}, 'service_min_lifetime': 2, 'daemon_path_workdir': '/opt/WebServices/Docs', 'daemon_path_pidfile': '/tmp/CISAppServer.pid', 'service_reserved_keys': ('service', 'name', 'scheduler', 'queue'), 'log_level_cli': None, 'log_level': 'INFO', 'gate_path_failed': None, 'gate_path_shared': 'Shared', 'pbs_max_jobs': 100, 'service_path_conf': 'Services', 'gate_path': {'running': None, 'failed': None, 'waiting': None, 'done': None, 'aborted': None, 'delete': None, 'queued': None, 'killed': None}, 'gate_path_exit': None, 'gate_path_aborted': None, 'service_max_lifetime': 24, 'config_file': None, 'config_sleep_time': 3, 'service_quota': 10000, 'pbs_default_queue': 'short', 'gate_path_killed': None, 'gate_path_jobs': None, 'pbs_path_queue': 'PBS/Queue', 'gate_path_waiting': None, 'service_states': ('waiting', 'queued', 'running', 'done', 'failed', 'aborted', 'killed', 'delete'), 'config_progress_step': 2, 'gate_path_done': None, 'gate_path_delete': None, 'gate_path_queued': None, 'gate_path_output': 'Output', 'service_job_size': 50, 'log_output': '/tmp/CISAppServer.log', 'service_path_data': 'Services/Data', 'log_output_cli': None}</em><a class="headerlink" href="#CISAppServer.Config.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Global Config class instance. Use it to access the CISAppGateway
configuration.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CISAppGateway.html" title="CISAppGateway Package"
             >previous</a> |</li>
        <li><a href="index.html">CIŚ Web Services 0.2 documentation</a> &raquo;</li>
          <li><a href="modules.html" >Implementation reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, CIŚ.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>