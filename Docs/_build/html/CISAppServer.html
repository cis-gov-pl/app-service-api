<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CISAppServer Package &mdash; CIŚ Web Services 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/cistheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="CIŚ Web Services 0.2 documentation" href="index.html" />
    <link rel="up" title="Implementation reference" href="modules.html" />
    <link rel="prev" title="CISAppGateway Package" href="CISAppGateway.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CISAppGateway.html" title="CISAppGateway Package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CIŚ Web Services 0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">Implementation reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="webapi.html">Web API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Implementation reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="modules.html#source-code">Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#running-webservice-locally">Running Webservice locally</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="modules.html#class-reference">Class reference</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="CISAppGateway.html"
                        title="previous chapter">CISAppGateway Package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/CISAppServer.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cisappserver-package">
<h1>CISAppServer Package<a class="headerlink" href="#cisappserver-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-CISAppServer.Globals">
<span id="globals-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Globals</span></code> Module<a class="headerlink" href="#module-CISAppServer.Globals" title="Permalink to this headline">¶</a></h2>
<p>Module with global instances</p>
<dl class="function">
<dt id="CISAppServer.Globals.init">
<code class="descclassname">CISAppServer.Globals.</code><code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Globals.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CISAppServer.Config">
<span id="config-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Config</span></code> Module<a class="headerlink" href="#module-CISAppServer.Config" title="Permalink to this headline">¶</a></h2>
<p>Global configuration for CISAppServer.</p>
<dl class="class">
<dt id="CISAppServer.Config.CISFormatter">
<em class="property">class </em><code class="descclassname">CISAppServer.Config.</code><code class="descname">CISFormatter</code><span class="sig-paren">(</span><em>fmt='%(levelno)s: %(msg)s'</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Config.CISFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></code></p>
<p>Specialised logging formatter class.</p>
<p>Increase the verbosity of ERROR level messages - include information about
the caller.</p>
<dl class="attribute">
<dt id="CISAppServer.Config.CISFormatter.err_fmt">
<code class="descname">err_fmt</code><em class="property"> = '%(levelname)7s %(asctime)s [%(threadName)s:%(filename)s:%(lineno)s - %(funcName)s()] :\n%(message)s'</em><a class="headerlink" href="#CISAppServer.Config.CISFormatter.err_fmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Format of ERROR messages</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.CISFormatter.format">
<code class="descname">format</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Config.CISFormatter.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloaded logging.Formatter.format method. Will adjust the message
format based on logging level.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Config.Config">
<em class="property">class </em><code class="descclassname">CISAppServer.Config.</code><code class="descname">Config</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Config.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<p>Class responsible for configuration storage and initialization.</p>
<p>Config stores variables as instace members e.g.:</p>
<blockquote>
<div>conf.config_file</div></blockquote>
<p>The variables are also accessible via dictionary interface e.g.:</p>
<blockquote>
<div>conf[&#8216;conf_file&#8217;]</div></blockquote>
<p>Upon initialisation some default values are applied to the variables.
However to finish the initialization <a class="reference internal" href="#CISAppServer.Config.Config.load" title="CISAppServer.Config.Config.load"><code class="xref py py-meth docutils literal"><span class="pre">Config.load()</span></code></a> method
should be called.</p>
<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_batch_jobs">
<code class="descname">config_batch_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_batch_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of jobs to be batched together for submit/finalise threads</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_db">
<code class="descname">config_db</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Job database URL in a SQLAlchemy format:
<a class="reference external" href="http://docs.sqlalchemy.org/en/rel_1_0/core/engines.html#supported-databases">http://docs.sqlalchemy.org/en/rel_1_0/core/engines.html#supported-databases</a></p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_db_init">
<code class="descname">config_db_init</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_db_init" title="Permalink to this definition">¶</a></dt>
<dd><p>List of SQL statements to be called after connection initialization.
Useful to set some DB engine configuration e.g. for SQLite
[&#8220;pragma foreign_keys=on&#8221;, &#8220;pragma journal_mode=WAL&#8221;]</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_db_recycle">
<code class="descname">config_db_recycle</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_db_recycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Time in second after which connection pool recycles. This should
prevent lost connections to MySQL which closes them by default after
8 hours.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_file">
<code class="descname">config_file</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Config file name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_garbage_step">
<code class="descname">config_garbage_step</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_garbage_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Every n-th status query run garbage collector</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_max_jobs">
<code class="descname">config_max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of all active jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_max_threads">
<code class="descname">config_max_threads</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_max_threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of active threads</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_progress_step">
<code class="descname">config_progress_step</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_progress_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Every n-th status query dump the progress logs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_shutdown_time">
<code class="descname">config_shutdown_time</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_shutdown_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Timeout for job cleanup before forcing shutdown</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_sleep_time">
<code class="descname">config_sleep_time</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_sleep_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Sleep interval in seconds between job status queries</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.config_wait_time">
<code class="descname">config_wait_time</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.config_wait_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Timeout for jobs with wait flag in seconds (Job with wait flag will
be ignored when processing the waiting queue)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_path_installdir">
<code class="descname">daemon_path_installdir</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_path_installdir" title="Permalink to this definition">¶</a></dt>
<dd><p>AppServer install directory</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_path_pidfile">
<code class="descname">daemon_path_pidfile</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_path_pidfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Daemon mode pid file path</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_path_workdir">
<code class="descname">daemon_path_workdir</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_path_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Working directory of daemon</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.daemon_pidfile_timeout">
<code class="descname">daemon_pidfile_timeout</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.daemon_pidfile_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Timeout for daemon mode pid file acquisition</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.dummy_max_jobs">
<code class="descname">dummy_max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.dummy_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent Dummy jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.dummy_turbo">
<code class="descname">dummy_turbo</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.dummy_turbo" title="Permalink to this definition">¶</a></dt>
<dd><p>Dummy scheduler turbo mode - all jobs finish instantly</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_aborted">
<code class="descname">gate_path_aborted</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_aborted" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where aborted jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_cleanup">
<code class="descname">gate_path_cleanup</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs during cleanup are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_closing">
<code class="descname">gate_path_closing</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_closing" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs waiting for cleanup are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_done">
<code class="descname">gate_path_done</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_done" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where done jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_dump">
<code class="descname">gate_path_dump</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs output is moved before removal (aleviates problems
with files that are still in use)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_failed">
<code class="descname">gate_path_failed</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_failed" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where failed jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_flags">
<code class="descname">gate_path_flags</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where job flags are stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_jobs">
<code class="descname">gate_path_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs description is stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_killed">
<code class="descname">gate_path_killed</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_killed" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where killed jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_new">
<code class="descname">gate_path_new</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where new jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_opts">
<code class="descname">gate_path_opts</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs internal state is stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_output">
<code class="descname">gate_path_output</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs output will be stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_processing">
<code class="descname">gate_path_processing</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_processing" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where jobs during submission are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_queued">
<code class="descname">gate_path_queued</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_queued" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where queued jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_running">
<code class="descname">gate_path_running</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_running" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where running jobs are symlinked</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_shared">
<code class="descname">gate_path_shared</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the shared storage used as communication medium with
AppGateway</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_time">
<code class="descname">gate_path_time</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where job timestamps are stored</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.gate_path_waiting">
<code class="descname">gate_path_waiting</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.gate_path_waiting" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where waiting jobs are symlinked</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.Config.json_load">
<code class="descname">json_load</code><span class="sig-paren">(</span><em>file</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Config.Config.json_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a JSON file</p>
<p>First remove comments and then use the json module package
Comments look like</p>
<div class="highlight-python"><div class="highlight"><pre>    // ...
or
    /*
    ...
    */
</pre></div>
</div>
<p>Based on:
<a class="reference external" href="http://www.lifl.fr/~riquetd/parse-a-json-file-with-comments.html">http://www.lifl.fr/~riquetd/parse-a-json-file-with-comments.html</a>.
Much faster than <a class="reference external" href="https://github.com/getify/JSON.minify">https://github.com/getify/JSON.minify</a> and
<a class="reference external" href="https://gist.github.com/WizKid/1170297">https://gist.github.com/WizKid/1170297</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> &#8211; name of the file to parse.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.Config.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>conf_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Config.Config.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load CISAppServer configuration from JSON file and finalize the
initialisation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conf_name</strong> &#8211; name of CISAppServer config file. When <em>None</em> is
provided hardcoded defaults are used.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_config">
<code class="descname">log_config</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of logging module</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_email">
<code class="descname">log_email</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Email to send the error messages</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_level">
<code class="descname">log_level</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging level</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_level_cli">
<code class="descname">log_level_cli</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_level_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging level CLI override</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_level_db">
<code class="descname">log_level_db</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_level_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging level for DB calls</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_output">
<code class="descname">log_output</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Log output file name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.log_output_cli">
<code class="descname">log_output_cli</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.log_output_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Log output file name CLI override</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Config.Config.mkdir_p">
<code class="descname">mkdir_p</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Config.Config.mkdir_p" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_default_queue">
<code class="descname">pbs_default_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of default PBS queue</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_max_jobs">
<code class="descname">pbs_max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent PBS jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_path_queue">
<code class="descname">pbs_path_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_path_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where PBS backend will store job IDs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.pbs_path_work">
<code class="descname">pbs_path_work</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.pbs_path_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where PBS backeng will create job working directories</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_allowed_sections">
<code class="descname">service_allowed_sections</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_allowed_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>Allowed sections in job submission JSON</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_default_scheduler">
<code class="descname">service_default_scheduler</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_default_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Default scheduler</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_flags">
<code class="descname">service_flags</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid job flags</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_job_size">
<code class="descname">service_job_size</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_job_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Default expected output size of a job in MB. It is used to estimate
space requirements for jobs that are to be scheduled.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_jobs">
<code class="descname">service_max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Default maximum number of concurrent jobs allowed per dervice</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_lifetime">
<code class="descname">service_max_lifetime</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Default job maximum lifetime in hours (supports fractions). Jobs
that are older then this will be removed by garbage collector.
Setting this to zero means jobs can be immortal (at least until
service quota is exceeded)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_nesting_level">
<code class="descname">service_max_nesting_level</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_nesting_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Limit of nested Object type variables
should prevent from endless recursive validation</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_max_runtime">
<code class="descname">service_max_runtime</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_max_runtime" title="Permalink to this definition">¶</a></dt>
<dd><p>Default job maximum running time in hours (supports fractions). Jobs
that are in running state longer then this will be killed and
removed by garbage collector.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_min_lifetime">
<code class="descname">service_min_lifetime</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_min_lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Default job minimum lifetime in hours (supports fractions). Jobs
that are younger then this cannot be removed by garbage collector</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_path_conf">
<code class="descname">service_path_conf</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_path_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Path with services configuration files</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_path_data">
<code class="descname">service_path_data</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_path_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Path with services scripts and input files</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_quota">
<code class="descname">service_quota</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_quota" title="Permalink to this definition">¶</a></dt>
<dd><p>Defaul maximum disk size used by service output files in MB</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_reserved_keys">
<code class="descname">service_reserved_keys</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_reserved_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Reserved key names for job parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_scheduler">
<code class="descname">service_scheduler</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Default scheduler</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_schedulers">
<code class="descname">service_schedulers</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_schedulers" title="Permalink to this definition">¶</a></dt>
<dd><p>Enabled schedulers</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_states">
<code class="descname">service_states</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid job states as well as names of directories on shared storage
that are used to monitor job states</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.service_username">
<code class="descname">service_username</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.service_username" title="Permalink to this definition">¶</a></dt>
<dd><p>Default user name for job execution</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.ssh_default_queue">
<code class="descname">ssh_default_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.ssh_default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of default SSH execution host</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.ssh_known_hosts">
<code class="descname">ssh_known_hosts</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.ssh_known_hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>Path for minimal known_hosts SSH file. Speeds up significantly older
paramiko versions. Requires a patch to spur
(available within AppServer repo)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.ssh_max_jobs">
<code class="descname">ssh_max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.ssh_max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent jobs per SSH execution host</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.ssh_path_queue">
<code class="descname">ssh_path_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.ssh_path_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where SSH backend will store job IDs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.Config.ssh_path_work">
<code class="descname">ssh_path_work</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Config.Config.ssh_path_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where SSH backeng will create job working directories</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Config.ExitCodes">
<em class="property">class </em><code class="descclassname">CISAppServer.Config.</code><code class="descname">ExitCodes</code><a class="headerlink" href="#CISAppServer.Config.ExitCodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Job exit codes enum:</p>
<ul class="simple">
<li>-100: Undefined (this should not happen)</li>
<li>-99: Abort (default)</li>
<li>-98: Shutdown</li>
<li>-97: Delete</li>
<li>-96: UserKill</li>
<li>-95: SchedulerKill</li>
<li>-94: Validate</li>
</ul>
<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.Abort">
<code class="descname">Abort</code><em class="property"> = -99</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.Abort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.Delete">
<code class="descname">Delete</code><em class="property"> = -97</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.Delete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.SchedulerKill">
<code class="descname">SchedulerKill</code><em class="property"> = -95</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.SchedulerKill" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.Shutdown">
<code class="descname">Shutdown</code><em class="property"> = -98</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.Shutdown" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.Undefined">
<code class="descname">Undefined</code><em class="property"> = -100</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.Undefined" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.UserKill">
<code class="descname">UserKill</code><em class="property"> = -96</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.UserKill" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Config.ExitCodes.Validate">
<code class="descname">Validate</code><em class="property"> = -94</em><a class="headerlink" href="#CISAppServer.Config.ExitCodes.Validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="data">
<dt id="CISAppServer.Config.conf">
<code class="descclassname">CISAppServer.Config.</code><code class="descname">conf</code><em class="property"> = {'gate_path_processing': None, 'gate_path_aborted': None, 'gate_path_queued': None, 'config_garbage_step': 5, 'ssh_known_hosts': '/home/konrad/.ssh/known_hosts', 'pbs_path_work': 'PBS/Scratch', 'service_max_lifetime': 24, 'gate_path_dump': 'Dump', 'service_max_jobs': 80, 'service_max_runtime': 12, 'gate_path_cleanup': None, 'daemon_pidfile_timeout': -1, 'gate_path_running': None, 'log_config': {'handlers': {'mail': {'toaddrs': '', 'level': 'ERROR', 'fromaddr': 'kklimaszewski&#64;cis.gov.pl', 'mailhost': 'localhost', 'formatter': 'debug', 'class': 'logging.handlers.SMTPHandler', 'subject': 'AppServer Error'}, 'console': {'formatter': 'simple', 'class': 'logging.StreamHandler', 'level': 'INFO'}, 'file': {'filename': '/tmp/CISAppServer.log', 'formatter': 'verbose', 'class': 'logging.FileHandler', 'level': 'INFO'}}, 'version': 1, 'root': {'level': 'INFO', 'handlers': ['console', 'file', 'mail']}, 'disable_existing_loggers': False, 'formatters': {'debug': {'format': '== %(levelname)7s %(asctime)s [%(threadName)s:%(filename)s:%(lineno)s - %(funcName)s()] :\n%(message)s'}, 'simple': {'format': '%(levelname)-8s %(message)s'}, 'verbose': {'()': &lt;class 'CISAppServer.Config.CISFormatter'&gt;, 'format': '%(levelname)7s %(asctime)s : %(message)s'}}}, 'log_email': '', 'daemon_path_workdir': '/home/konrad/Seafile/Work/Soft/WebServices/Docs', 'daemon_path_pidfile': '/tmp/CISAppServer.pid', 'service_reserved_keys': ('CIS_SCHEDULER', 'CIS_QUEUE', 'CIS_SSH_HOST'), 'log_level_cli': None, 'log_level': 'INFO', 'config_max_threads': 4, 'service_min_lifetime': 2, 'gate_path_failed': None, 'service_username': 'apprunner', 'ssh_max_jobs': {'localhost': 2}, 'gate_path_flags': None, 'gate_path_shared': 'Shared', 'ssh_default_queue': 'localhost', 'dummy_turbo': False, 'pbs_max_jobs': 100, 'service_path_conf': 'Services', 'gate_path_opts': None, 'service_scheduler': 'pbs', 'gate_path_jobs': None, 'gate_path_flag_wait_quota': None, 'service_flags': ('stop', 'delete', 'wait_quota', 'wait_input', 'old_api'), 'service_schedulers': ('pbs', 'ssh', 'dummy'), 'config_max_jobs': 1000, 'config_file': None, 'config_sleep_time': 5, 'service_quota': 10000, 'pbs_default_queue': 'a12h', 'gate_path_new': None, 'config_db': 'sqlite:///jobs.db', 'daemon_path_installdir': '/home/konrad/Seafile/Work/Soft/WebServices/AppServer/CISAppServer', 'pbs_path_queue': 'PBS/Queue', 'ssh_path_work': 'SSH/Scratch', 'gate_path_flag_stop': None, 'service_max_nesting_level': 1, 'gate_path': {'flag_old_api': None, 'flag_wait_input': None, 'processing': None, 'flag_stop': None, 'running': None, 'killed': None, 'failed': None, 'waiting': None, 'cleanup': None, 'done': None, 'aborted': None, 'flag_delete': None, 'new': None, 'closing': None, 'flag_wait_quota': None, 'queued': None}, 'service_states': ('new', 'waiting', 'processing', 'queued', 'running', 'closing', 'cleanup', 'done', 'failed', 'aborted', 'killed'), 'config_wait_time': 120, 'gate_path_flag_old_api': None, 'service_default_scheduler': 'pbs', 'ssh_path_queue': 'SSH/Queue', 'config_shutdown_time': 2, 'service_job_size': 50, 'config_db_init': (), 'service_allowed_sections': ('service', 'api', 'input', 'chain'), 'dummy_max_jobs': 100, 'config_progress_step': 1, 'gate_path_done': None, 'config_db_recycle': 3600, 'gate_path_flag_delete': None, 'log_level_db': 'WARN', 'gate_path_waiting': None, 'gate_path_closing': None, 'gate_path_output': 'Output', 'gate_path_flag_wait_input': None, 'config_batch_jobs': 10, 'log_output': '/tmp/CISAppServer.log', 'service_path_data': 'Services/Data', 'gate_path_time': None, 'gate_path_killed': None, 'log_output_cli': None}</em><a class="headerlink" href="#CISAppServer.Config.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Global Config class instance. Use it to access the CISAppGateway
configuration.</p>
</dd></dl>

</div>
<div class="section" id="module-CISAppServer.JobManager">
<span id="jobmanager-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">JobManager</span></code> Module<a class="headerlink" href="#module-CISAppServer.JobManager" title="Permalink to this headline">¶</a></h2>
<p>Main module of CISAppServer. Responsible for job management.</p>
<dl class="class">
<dt id="CISAppServer.JobManager.JobManager">
<em class="property">class </em><code class="descclassname">CISAppServer.JobManager.</code><code class="descname">JobManager</code><a class="headerlink" href="#CISAppServer.JobManager.JobManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Main calss of CISAppServer. It is responsible for job management.</p>
<p>Upon initialization sets up Validator and Scheduler interfaces.</p>
<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.batch_cleanup">
<code class="descname">batch_cleanup</code><span class="sig-paren">(</span><em>batch</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.batch_cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.batch_submit">
<code class="descname">batch_submit</code><span class="sig-paren">(</span><em>batch</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.batch_submit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_cleanup">
<code class="descname">check_cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Check jobs marked for cleanup.</p>
<p>Starts the cleanup for the jobs in separate threads.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_deleted_jobs">
<code class="descname">check_deleted_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_deleted_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for jobs marked for removal.</p>
<p>If found remove all resources related to the job. If a job is still
running kill it.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_finished_threads">
<code class="descname">check_finished_threads</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_finished_threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for cleanup threads that finished execution.</p>
<p>If found finalise them.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_job_kill_requests">
<code class="descname">check_job_kill_requests</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_job_kill_requests" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for job kill requests.</p>
<p>If found and job is still running kill it.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_new_jobs">
<code class="descname">check_new_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_new_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for new job files in the queue directory.</p>
<p>If found try to submit them to selected job scheduler.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_old_jobs">
<code class="descname">check_old_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_old_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for jobs that exceed their life time.</p>
<p>If found mark them for removal.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_running_jobs">
<code class="descname">check_running_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_running_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check status of running jobs.</p>
<p>Finished jobs will be marked for finalisation</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.check_stuck_jobs">
<code class="descname">check_stuck_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.check_stuck_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for jobs in processing and cleanup states. If found when
AppServer is starting they have to be reset to waiting and closing
states as otherwise nothing will tuch them. When we are starting no
worker is present that was supposed to take care of those jobs.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.collect_garbage">
<code class="descname">collect_garbage</code><span class="sig-paren">(</span><em>full=False</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.collect_garbage" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if service quota is not exceeded. If yes remove oldest finished
jobs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>full</strong> &#8211; If True force garbage collection even if disk usage is
not above alloted quota. In addition removes all jobs older than
min job life time.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.init">
<code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize JobManager. Creates new instances of Validator and
Schedulers. Loads existing jobs from file system.</p>
<p>Existing state is purged.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.reload_config">
<code class="descname">reload_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.reload_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.report_jobs">
<code class="descname">report_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.report_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the current queue state.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of JobManager.</p>
<ul class="simple">
<li>Check for new jobs - submit them if found,</li>
<li>Check for finished jobs - retrive output if found,</li>
<li>Check for jobs exceeding their life time - mark for removal,</li>
<li>Check for jobs to be removed - delete all related resources.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.shutdown">
<code class="descname">shutdown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop all running jobs.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.start_queue">
<code class="descname">start_queue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.start_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Restart the queue.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.stop_queue">
<code class="descname">stop_queue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.stop_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Pause the queue. New jobs will not be processed.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.JobManager.JobManager.terminate">
<code class="descname">terminate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.JobManager.terminate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="CISAppServer.JobManager.worker_cleanup">
<code class="descclassname">CISAppServer.JobManager.</code><code class="descname">worker_cleanup</code><span class="sig-paren">(</span><em>job_ids</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.worker_cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.JobManager.worker_cleanup_profile">
<code class="descclassname">CISAppServer.JobManager.</code><code class="descname">worker_cleanup_profile</code><span class="sig-paren">(</span><em>job_ids</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.worker_cleanup_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Profile cleanup worker.</p>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.JobManager.worker_init">
<code class="descclassname">CISAppServer.JobManager.</code><code class="descname">worker_init</code><span class="sig-paren">(</span><em>config</em>, <em>work_id</em>, <em>lock</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.worker_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize worker process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>config</strong> &#8211; Config.Config instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.JobManager.worker_submit">
<code class="descclassname">CISAppServer.JobManager.</code><code class="descname">worker_submit</code><span class="sig-paren">(</span><em>job_ids</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.worker_submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate job related scripts and submit them to selected scheduler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; The Job object to submit.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success, False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.JobManager.worker_submit_profile">
<code class="descclassname">CISAppServer.JobManager.</code><code class="descname">worker_submit_profile</code><span class="sig-paren">(</span><em>job_ids</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.JobManager.worker_submit_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Profile submit worker.</p>
</dd></dl>

</div>
<div class="section" id="module-CISAppServer.Jobs">
<span id="jobs-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Jobs</span></code> Module<a class="headerlink" href="#module-CISAppServer.Jobs" title="Permalink to this headline">¶</a></h2>
<p>Module with implementation of Job objects and their interaction with underlying
DB.</p>
<dl class="class">
<dt id="CISAppServer.Jobs.Base">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">Base</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Base" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CISAppServer.Jobs.UnicodeBase" title="CISAppServer.Jobs.UnicodeBase"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Jobs.UnicodeBase</span></code></a></p>
<p>Base class for SQLAlchemy ORM objects</p>
<dl class="attribute">
<dt id="CISAppServer.Jobs.Base.metadata">
<code class="descname">metadata</code><em class="property"> = MetaData(bind=None)</em><a class="headerlink" href="#CISAppServer.Jobs.Base.metadata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.FileStateManager">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">FileStateManager</code><a class="headerlink" href="#CISAppServer.Jobs.FileStateManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CISAppServer.Jobs.StateManager" title="CISAppServer.Jobs.StateManager"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Jobs.StateManager</span></code></a></p>
<dl class="method">
<dt id="CISAppServer.Jobs.FileStateManager.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><em>id</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.FileStateManager.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup after job removal.</p>
<p>Removes the flags and other files representing job state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>id</strong> &#8211; JobID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.FileStateManager.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.FileStateManager.commit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.FileStateManager.get_new_job_list">
<code class="descname">get_new_job_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.FileStateManager.get_new_job_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.FileStateManager.new_job">
<code class="descname">new_job</code><span class="sig-paren">(</span><em>jid</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.FileStateManager.new_job" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.FileStateManager.poll_gw">
<code class="descname">poll_gw</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.FileStateManager.poll_gw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.Job">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">Job</code><span class="sig-paren">(</span><em>job_id</em>, <em>job_state=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.ext.declarative.Base</span></code></p>
<p>Class that implements a job instance.</p>
<p>Allows to:</p>
<ul class="simple">
<li>query/set job state,</li>
<li>generate the output status file,</li>
<li>query job parameters defined in job request.</li>
</ul>
<p>Class is based of SQLAlchemy declarative.Base and allows for easy
persistance and searching of the Jobs instances.</p>
<p>Works with existing job requests that are identified by their unique ID
string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job_id</strong> &#8211; The unique job ID.</li>
<li><strong>job_state</strong> &#8211; Existing JobState instance to associate with the new
Job.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="CISAppServer.Jobs.Job.calculate_size">
<code class="descname">calculate_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.calculate_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate size of output directory of the job if it exists.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.chain">
<code class="descname">chain</code><a class="headerlink" href="#CISAppServer.Jobs.Job.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>List of job IDs whose output we would like to consume (job chaining)</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as in cleanup state.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as in closing state.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.compact">
<code class="descname">compact</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.compact" title="Permalink to this definition">¶</a></dt>
<dd><p>Release resources allocated for the job</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.data">
<code class="descname">data</code><a class="headerlink" href="#CISAppServer.Jobs.Job.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Job parameters after validation</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job for removal.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.die">
<code class="descname">die</code><span class="sig-paren">(</span><em>message</em>, <em>exit_code=-99</em>, <em>err=True</em>, <em>exc_info=False</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.die" title="Permalink to this definition">¶</a></dt>
<dd><p>Abort further job execution with proper error in AppServer log as well
as with proper message for client in the job output status file. Sets
job state as <em>closing</em>. After cleanup the job state will be <em>aborted</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; Message to be passed to logs and client,</li>
<li><strong>exit_code</strong> &#8211; One of <code class="xref py py-class docutils literal"><span class="pre">ExitCodes</span></code>,</li>
<li><strong>err</strong> &#8211; if True use log as ERROR otherwise use WARNING priority,</li>
<li><strong>exc_info</strong> &#8211; if True logging will extract current exception info
(use in except block to provide additional information to the
logger).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.exit">
<code class="descname">exit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalise job cleanup by setting the state and passing the exit message
to the user. Should be called only after Job.finish() method was
called.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.finish">
<code class="descname">finish</code><span class="sig-paren">(</span><em>message</em>, <em>state='done'</em>, <em>exit_code=0</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as finished. Job will be set into <em>closing</em> state. When
cleanup is finished the <a class="reference internal" href="#CISAppServer.Jobs.Job.exit" title="CISAppServer.Jobs.Job.exit"><code class="xref py py-meth docutils literal"><span class="pre">exit()</span></code></a> method should be called to set
the job into its &#8220;exit state&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; that will be passed to user,</li>
<li><strong>state</strong> &#8211; Job state after cleanup will finish. One of:
[&#8216;done&#8217;, &#8216;failed&#8217;, &#8216;aborted&#8217;, &#8216;killed&#8217;],
:param exit_code: one of <code class="xref py py-class docutils literal"><span class="pre">ExitCodes</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.get_exit_state">
<code class="descname">get_exit_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.get_exit_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get job &#8220;exit state&#8221; - the state that job will be put into after it is
finalised. The &#8220;exit state&#8221; is set using <a class="reference internal" href="#CISAppServer.Jobs.Job.finish" title="CISAppServer.Jobs.Job.finish"><code class="xref py py-meth docutils literal"><span class="pre">finish()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>One of valid job exit states or None if the &#8220;exit state&#8221; is</dt>
<dd>not yet defined:</dd>
</dl>
<ul>
<li><dl class="first docutils">
<dt>done:</dt>
<dd>job has finished,</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>failed:</dt>
<dd>job has finished with non zero exit code,</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>aborted:</dt>
<dd>an error occurred during job preprocessing, submission or
postprocessing,</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>killed:</dt>
<dd>job was killed,</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.get_flag">
<code class="descname">get_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.get_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value of job flag.</p>
<dl class="docutils">
<dt>Valid flags are defined in <a class="reference internal" href="#CISAppServer.Jobs.JobState" title="CISAppServer.Jobs.JobState"><code class="xref py py-class docutils literal"><span class="pre">JobState</span></code></a>:</dt>
<dd>FLAG_DELETE, FLAG_STOP, FLAG_WAIT_QUOTA, FLAG_WAIT_INPUT,
FLAG_OLD_API, FLAG_ALL</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flag</strong> &#8211; a flag or set of flags to check. e.g.
job.get_flag(JobState.FLAG_WAIT_QUOTA)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the value of a flag.  In case of multiple flags like
(JobState.FLAG_WAIT_QUOTA | JobState.FLAG_WAIT_INPUT)
the return value is 1 when all flags are ON and 0 otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.get_size">
<code class="descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of job output directory.
Requires that calculate_size was called first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Size of output directory in bytes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.get_state">
<code class="descname">get_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.get_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get current job state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">One of valid job states:</td>
</tr>
</tbody>
</table>
<ul>
<li><dl class="first docutils">
<dt>waiting:</dt>
<dd><p class="first last">job request was submitted and is waiting for JobManager to process
it,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>processing:</dt>
<dd><p class="first last">job request was submitted and JobManager is processing it,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>queued:</dt>
<dd><p class="first last">job reuest was processed and is queued in the scheduling backend,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>running:</dt>
<dd><p class="first last">job is running on a compute node,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>closing:</dt>
<dd><p class="first last">job has finished and is waiting for cleanup,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>cleanup:</dt>
<dd><p class="first last">job has finished and cleanup of resources is performed,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>done:</dt>
<dd><p class="first last">job has finished,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>failed:</dt>
<dd><p class="first last">job has finished with non zero exit code,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>aborted:</dt>
<dd><p class="first last">an error occurred during job preprocessing, submission or
postprocessing,</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>killed:</dt>
<dd><p class="first last">job was killed,</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.id">
<code class="descname">id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the job unique identifier.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.key">
<code class="descname">key</code><a class="headerlink" href="#CISAppServer.Jobs.Job.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary key - autoincrement</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.mark">
<code class="descname">mark</code><span class="sig-paren">(</span><em>message</em>, <em>exit_code=-96</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.mark" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as killed by user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; that will be passed to user,</li>
<li><strong>exit_code</strong> &#8211; one of <code class="xref py py-class docutils literal"><span class="pre">ExitCodes</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.processing">
<code class="descname">processing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.processing" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as in processing state.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.queue">
<code class="descname">queue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as queued.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as running.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.scheduler">
<code class="descname">scheduler</code><a class="headerlink" href="#CISAppServer.Jobs.Job.scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores scheduler related info for jobs that were passed to the scheduler</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.set_flag">
<code class="descname">set_flag</code><span class="sig-paren">(</span><em>flag</em>, <em>remove=False</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.set_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a job flag.</p>
<dl class="docutils">
<dt>Valid flags are defined in <a class="reference internal" href="#CISAppServer.Jobs.JobState" title="CISAppServer.Jobs.JobState"><code class="xref py py-class docutils literal"><span class="pre">JobState</span></code></a>:</dt>
<dd>FLAG_DELETE, FLAG_STOP, FLAG_WAIT_QUOTA, FLAG_WAIT_INPUT,
FLAG_OLD_API, FLAG_ALL</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flag</strong> &#8211; a flag or set of flags to set. e.g.
job.set_flag(JobState.FLAG_WAIT_QUOTA | JobState.FLAG_WAIT_INPUT)</li>
<li><strong>remove</strong> &#8211; if False the flag bit is set to ON,
it is set to OFF otherwise</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.size">
<code class="descname">size</code><a class="headerlink" href="#CISAppServer.Jobs.Job.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Job output size in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.status">
<code class="descname">status</code><a class="headerlink" href="#CISAppServer.Jobs.Job.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Job state synchronized with AppGateway</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.Job.status_key">
<code class="descname">status_key</code><a class="headerlink" href="#CISAppServer.Jobs.Job.status_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.Job.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.Job.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark job as in waiting state.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Jobs.JobBadStateError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">JobBadStateError</code><a class="headerlink" href="#CISAppServer.Jobs.JobBadStateError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Wrong job state exception.</p>
</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.JobChain">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">JobChain</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.JobChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.ext.declarative.Base</span></code></p>
<p>Class that stores chained Job IDs.</p>
<p>A simple constructor that allows initialization from kwargs.</p>
<p>Sets attributes on the constructed instance using the names and
values in <code class="docutils literal"><span class="pre">kwargs</span></code>.</p>
<p>Only keys that are present as
attributes of the instance&#8217;s class are allowed. These could be,
for example, any mapped columns or relationships.</p>
<dl class="attribute">
<dt id="CISAppServer.Jobs.JobChain.id">
<code class="descname">id</code><a class="headerlink" href="#CISAppServer.Jobs.JobChain.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Id of Job chained as input</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobChain.job_key">
<code class="descname">job_key</code><a class="headerlink" href="#CISAppServer.Jobs.JobChain.job_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key (links to Job)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobChain.key">
<code class="descname">key</code><a class="headerlink" href="#CISAppServer.Jobs.JobChain.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary key - autoincrement</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.JobData">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">JobData</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.JobData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.ext.declarative.Base</span></code></p>
<p>Class that stores Job validated input data.</p>
<p>A simple constructor that allows initialization from kwargs.</p>
<p>Sets attributes on the constructed instance using the names and
values in <code class="docutils literal"><span class="pre">kwargs</span></code>.</p>
<p>Only keys that are present as
attributes of the instance&#8217;s class are allowed. These could be,
for example, any mapped columns or relationships.</p>
<dl class="attribute">
<dt id="CISAppServer.Jobs.JobData.data">
<code class="descname">data</code><a class="headerlink" href="#CISAppServer.Jobs.JobData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickled dictionary with Job validated settings</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobData.job_key">
<code class="descname">job_key</code><a class="headerlink" href="#CISAppServer.Jobs.JobData.job_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key (links to Job)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobData.key">
<code class="descname">key</code><a class="headerlink" href="#CISAppServer.Jobs.JobData.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary key - autoincrement</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.JobState">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">JobState</code><span class="sig-paren">(</span><em>id</em>, <em>service=None</em>, <em>scheduler=None</em>, <em>state=None</em>, <em>exit_message=None</em>, <em>exit_state=None</em>, <em>exit_code=None</em>, <em>submit_time=None</em>, <em>start_time=None</em>, <em>stop_time=None</em>, <em>wait_time=None</em>, <em>flags=0</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.JobState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.ext.declarative.Base</span></code></p>
<p>Class that stores information about Job state that will be synchronized
with AppGateway.</p>
<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_ALL">
<code class="descname">D_ALL</code><em class="property"> = 4095</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_ALL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_EXIT_CODE">
<code class="descname">D_EXIT_CODE</code><em class="property"> = 64</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_EXIT_CODE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_EXIT_MESSAGE">
<code class="descname">D_EXIT_MESSAGE</code><em class="property"> = 16</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_EXIT_MESSAGE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_EXIT_STATE">
<code class="descname">D_EXIT_STATE</code><em class="property"> = 32</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_EXIT_STATE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_FLAGS">
<code class="descname">D_FLAGS</code><em class="property"> = 2048</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_FLAGS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_ID">
<code class="descname">D_ID</code><em class="property"> = 1</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_SCHEDULER">
<code class="descname">D_SCHEDULER</code><em class="property"> = 4</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_SCHEDULER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_SERVICE">
<code class="descname">D_SERVICE</code><em class="property"> = 2</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_SERVICE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_START_TIME">
<code class="descname">D_START_TIME</code><em class="property"> = 256</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_START_TIME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_STATE">
<code class="descname">D_STATE</code><em class="property"> = 8</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_STATE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_STOP_TIME">
<code class="descname">D_STOP_TIME</code><em class="property"> = 512</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_STOP_TIME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_SUBMIT_TIME">
<code class="descname">D_SUBMIT_TIME</code><em class="property"> = 128</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_SUBMIT_TIME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.D_WAIT_TIME">
<code class="descname">D_WAIT_TIME</code><em class="property"> = 1024</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.D_WAIT_TIME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.FLAG_ALL">
<code class="descname">FLAG_ALL</code><em class="property"> = 31</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.FLAG_ALL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.FLAG_DELETE">
<code class="descname">FLAG_DELETE</code><em class="property"> = 1</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.FLAG_DELETE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.FLAG_OLD_API">
<code class="descname">FLAG_OLD_API</code><em class="property"> = 16</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.FLAG_OLD_API" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.FLAG_STOP">
<code class="descname">FLAG_STOP</code><em class="property"> = 2</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.FLAG_STOP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.FLAG_WAIT_INPUT">
<code class="descname">FLAG_WAIT_INPUT</code><em class="property"> = 8</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.FLAG_WAIT_INPUT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.FLAG_WAIT_QUOTA">
<code class="descname">FLAG_WAIT_QUOTA</code><em class="property"> = 4</em><a class="headerlink" href="#CISAppServer.Jobs.JobState.FLAG_WAIT_QUOTA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.attr_dirty">
<code class="descname">attr_dirty</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.attr_dirty" title="Permalink to this definition">¶</a></dt>
<dd><p>Dirty status of job attributes</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.exit_code">
<code class="descname">exit_code</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.exit_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Job exit code</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.exit_message">
<code class="descname">exit_message</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.exit_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Job exit message</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.exit_state">
<code class="descname">exit_state</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.exit_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Job exit state</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.flags">
<code class="descname">flags</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Job flags: delete, stop, wait_quita, wait_input, old_api</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.flags_dirty">
<code class="descname">flags_dirty</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.flags_dirty" title="Permalink to this definition">¶</a></dt>
<dd><p>Dirty status of job flags</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.id">
<code class="descname">id</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key (links to Job)
Job unique identifier</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.key">
<code class="descname">key</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary key - autoincrement</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.scheduler">
<code class="descname">scheduler</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Jobs&#8217; Scheduler</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.service">
<code class="descname">service</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.service" title="Permalink to this definition">¶</a></dt>
<dd><p>Jobs&#8217; Service</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.start_time">
<code class="descname">start_time</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time when job execution started</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.state">
<code class="descname">state</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.state" title="Permalink to this definition">¶</a></dt>
<dd><p>Current job state</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.stop_time">
<code class="descname">stop_time</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.stop_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time when job execution ended</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.submit_time">
<code class="descname">submit_time</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.submit_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time when job was submitted</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.JobState.wait_time">
<code class="descname">wait_time</code><a class="headerlink" href="#CISAppServer.Jobs.JobState.wait_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time when wait flag was set</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.MutableDict">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">MutableDict</code><a class="headerlink" href="#CISAppServer.Jobs.MutableDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.ext.mutable.Mutable</span></code>, <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<p>This class allows to store dict (which is mutable) as immutable column
in DB (e.g. pickled string) using SQLAlchemy. The dict will be mutable in
ORM and SQLAlchemy will correctly detect changes.</p>
<dl class="classmethod">
<dt id="CISAppServer.Jobs.MutableDict.coerce">
<em class="property">classmethod </em><code class="descname">coerce</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.MutableDict.coerce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.SchedulerQueue">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">SchedulerQueue</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.SchedulerQueue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.ext.declarative.Base</span></code></p>
<p>Class that stores scheduler related Job data.</p>
<p>A simple constructor that allows initialization from kwargs.</p>
<p>Sets attributes on the constructed instance using the names and
values in <code class="docutils literal"><span class="pre">kwargs</span></code>.</p>
<p>Only keys that are present as
attributes of the instance&#8217;s class are allowed. These could be,
for example, any mapped columns or relationships.</p>
<dl class="attribute">
<dt id="CISAppServer.Jobs.SchedulerQueue.id">
<code class="descname">id</code><a class="headerlink" href="#CISAppServer.Jobs.SchedulerQueue.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler job ID</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.SchedulerQueue.job_key">
<code class="descname">job_key</code><a class="headerlink" href="#CISAppServer.Jobs.SchedulerQueue.job_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Foreign key (links to Job)</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.SchedulerQueue.key">
<code class="descname">key</code><a class="headerlink" href="#CISAppServer.Jobs.SchedulerQueue.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary key - autoincrement</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.SchedulerQueue.queue">
<code class="descname">queue</code><a class="headerlink" href="#CISAppServer.Jobs.SchedulerQueue.queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Queue</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Jobs.SchedulerQueue.scheduler">
<code class="descname">scheduler</code><a class="headerlink" href="#CISAppServer.Jobs.SchedulerQueue.scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.StateManager">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">StateManager</code><a class="headerlink" href="#CISAppServer.Jobs.StateManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Interface for persistent storage of job states and management of the job
queue.</p>
<p>Based on SQLite database allows for creation, menagement and querying of
jobs.</p>
<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.attach_job">
<code class="descname">attach_job</code><span class="sig-paren">(</span><em>job</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.attach_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach a Job instance to the DB session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job</strong> &#8211; the Job instance.</li>
<li><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.check_commit">
<code class="descname">check_commit</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.check_commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commit changes to the DB. Repeat several times in case of failure.
Invalidates SQLAlchemy ORM instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if succeded, False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><em>job_id</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup AppGW state after Job removal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job_id</strong> &#8211; Job ID.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commit changes to the DB. Invalidates SQLAlchemy ORM instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.delete_job">
<code class="descname">delete_job</code><span class="sig-paren">(</span><em>job</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.delete_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all job persistant data. Except for the output directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jid</strong> &#8211; Job ID</td>
</tr>
<tr class="field-even field"><th class="field-name">Throws:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.detach_job">
<code class="descname">detach_job</code><span class="sig-paren">(</span><em>job</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.detach_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach a Job instance to the DB session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job</strong> &#8211; the Job instance.</li>
<li><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.expire_session">
<code class="descname">expire_session</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.expire_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Expire session cache. Will reload all objects from the DB on next
access.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush changes to the DB transaction. The data are not persisted (or
available for other transactions) until a call to commit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_active_job_count">
<code class="descname">get_active_job_count</code><span class="sig-paren">(</span><em>service=None</em>, <em>scheduler=None</em>, <em>flag=None</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_active_job_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a count of jobs that are active.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>service</strong> (<em>str</em>) &#8211; if specified select only jobs that belong to
selected service.</li>
<li><strong>flag</strong> (<em>int</em>) &#8211; if specified select only jobs with the flag (or set of
flags) set to ON. Valid flags are defined in <code class="xref py py-class docutils literal"><span class="pre">JobSTate</span></code>.</li>
<li><strong>session</strong> (<em>Session</em>) &#8211; if specified use this session instance instead
of the default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Number of jobs in the selected state, or -1 in case of error.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_active_service_counters">
<code class="descname">get_active_service_counters</code><span class="sig-paren">(</span><em>scheduler=None</em>, <em>flag=None</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_active_service_counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a count of jobs that are in a selected state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>service</strong> (<em>str</em>) &#8211; if specified select only jobs that belong to
selected service.</li>
<li><strong>flag</strong> (<em>int</em>) &#8211; if specified select only jobs with the flag (or set of
flags) set to ON. Valid flags are defined in <code class="xref py py-class docutils literal"><span class="pre">JobSTate</span></code>.</li>
<li><strong>session</strong> (<em>Session</em>) &#8211; if specified use this session instance instead
of the default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Number of jobs in the selected state, or -1 in case of error.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_job">
<code class="descname">get_job</code><span class="sig-paren">(</span><em>job_id</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Job object from the job queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>job_id</strong> &#8211; Job unique ID,</li>
<li><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Job object for <em>job_id</em>, None if job_id was not found in the
queue.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_job_count">
<code class="descname">get_job_count</code><span class="sig-paren">(</span><em>state='all'</em>, <em>service=None</em>, <em>scheduler=None</em>, <em>flag=None</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_job_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a count of jobs that are in a selected state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>state</strong> (<em>str</em>) &#8211; Specifies state for which Jobs will be selected. To
select all jobs specify &#8216;all&#8217; as the state. Valid states consist of
job states and flags: waiting, processing, queued, running,
closing, cleanup, done, failed, aborted, killed</li>
<li><strong>service</strong> (<em>str</em>) &#8211; if specified select only jobs that belong to
selected service.</li>
<li><strong>flag</strong> (<em>int</em>) &#8211; if specified select only jobs with the flag (or set of
flags) set to ON. Valid flags are defined in <code class="xref py py-class docutils literal"><span class="pre">JobSTate</span></code>.</li>
<li><strong>session</strong> (<em>Session</em>) &#8211; if specified use this session instance instead
of the default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Number of jobs in the selected state, or -1 in case of error.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_job_list">
<code class="descname">get_job_list</code><span class="sig-paren">(</span><em>state='all'</em>, <em>service=None</em>, <em>scheduler=None</em>, <em>flag=None</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_job_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of jobs that are in a selected state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>state</strong> &#8211; Specifies state for which Jobs will be selected. To
select all jobs specify &#8216;all&#8217; as the state. Valid states consist of
job states and flags: waiting, processing, queued, running,
closing, cleanup, done, failed, aborted, killed</li>
<li><strong>service</strong> &#8211; if specified select only jobs that belong to selected
service.</li>
<li><strong>flag</strong> &#8211; if specified select only jobs with the flag (or set of
flags) set to ON. Valid flags are defined in <code class="xref py py-class docutils literal"><span class="pre">JobSTate</span></code>.</li>
<li><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of Job instances sorted by submit time.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_job_list_byid">
<code class="descname">get_job_list_byid</code><span class="sig-paren">(</span><em>ids</em>, <em>session=None</em>, <em>full=False</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_job_list_byid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of jobs that are in a selected state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ids</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of Job instances sorted by submit time.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_job_state_counters">
<code class="descname">get_job_state_counters</code><span class="sig-paren">(</span><em>service=None</em>, <em>scheduler=None</em>, <em>flag=None</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_job_state_counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a count of jobs that are in a selected state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>service</strong> (<em>str</em>) &#8211; if specified select only jobs that belong to
selected service.</li>
<li><strong>flag</strong> (<em>int</em>) &#8211; if specified select only jobs with the flag (or set of
flags) set to ON. Valid flags are defined in <code class="xref py py-class docutils literal"><span class="pre">JobSTate</span></code>.</li>
<li><strong>session</strong> (<em>Session</em>) &#8211; if specified use this session instance instead
of the default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Number of jobs in the selected state, or -1 in case of error.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_new_job_list">
<code class="descname">get_new_job_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_new_job_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Query AppGW for a list of jobs that are in a <em>new</em> state.</p>
<p>For each job in <em>new</em> state a Job instance will be created and attached
to the default DB session. The jobs are set into waiting state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of Job instances that were in the <em>new</em> state.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.get_quota_service_counters">
<code class="descname">get_quota_service_counters</code><span class="sig-paren">(</span><em>scheduler=None</em>, <em>flag=None</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.get_quota_service_counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a size of quota used by jobs per service.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scheduler</strong> (<em>str</em>) &#8211; if specified select only jobs that belong to
selected scheduler.</li>
<li><strong>flag</strong> (<em>int</em>) &#8211; if specified select only jobs with the flag (or set of
flags) set to ON. Valid flags are defined in <code class="xref py py-class docutils literal"><span class="pre">JobSTate</span></code>.</li>
<li><strong>session</strong> (<em>Session</em>) &#8211; if specified use this session instance instead
of the default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Number of jobs in the selected state, or -1 in case of error.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.init">
<code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize StateManager. Should be done explicitely after
configuration is loaded.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.merge_job">
<code class="descname">merge_job</code><span class="sig-paren">(</span><em>job</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.merge_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge state of a Job instance into the DB session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job</strong> &#8211; the Job instance.</li>
<li><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.new_job">
<code class="descname">new_job</code><span class="sig-paren">(</span><em>job_id</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.new_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new Job instance with job_id identifier and attach it to DB
session.</p>
<p>Depending on the implementation can query the AppGW and set the proper
job state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job_id</strong> &#8211; the unique job identifier.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the new Job instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.new_session">
<code class="descname">new_session</code><span class="sig-paren">(</span><em>autoflush=True</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.new_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new DB session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">session instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.poll_gw">
<code class="descname">poll_gw</code><span class="sig-paren">(</span><em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.poll_gw" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for changes in job states issued by the AppGW.</p>
<p>If found merge them into the DB.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> &#8211; if specified use this session instance instead of the
default.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Jobs.StateManager.remove_flags">
<code class="descname">remove_flags</code><span class="sig-paren">(</span><em>flag</em>, <em>service='all'</em>, <em>session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.StateManager.remove_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear flags for jobs that belong to selected service.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>flag</strong> &#8211; The flag to clear.</li>
<li><strong>service</strong> &#8211; Name of the affected service. If equals to &#8220;all&#8221; flag
is cleared for every job.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Throws:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Jobs.UnicodeBase">
<em class="property">class </em><code class="descclassname">CISAppServer.Jobs.</code><code class="descname">UnicodeBase</code><a class="headerlink" href="#CISAppServer.Jobs.UnicodeBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class can be used by <code class="docutils literal"><span class="pre">declarative_base</span></code>, to add an automatic
<code class="docutils literal"><span class="pre">__unicode__</span></code> method to <em>all</em> subclasses of <code class="docutils literal"><span class="pre">Base</span></code>. This <code class="docutils literal"><span class="pre">__unicode__</span></code> will
represent values as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ClassName</span><span class="p">(</span><span class="n">col_1</span><span class="o">=</span><span class="n">value_1</span><span class="p">,</span> <span class="n">col_2</span><span class="o">=</span><span class="n">value_2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">col_n</span><span class="o">=</span><span class="n">value_n</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">col_1..col_n</span></code> are the columns of the mapped table with the
corresponding values.</p>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.delete_job_state">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">delete_job_state</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.delete_job_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.flush_session">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">flush_session</code><span class="sig-paren">(</span><em>thissession</em>, <em>flush_context</em>, <em>instances</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.flush_session" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_exit_code">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_exit_code</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_exit_code" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_exit_message">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_exit_message</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_exit_message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_exit_state">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_exit_state</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_exit_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_flags">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_flags</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_id">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_id</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_scheduler">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_scheduler</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_scheduler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_service">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_service</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_service" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_start_time">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_start_time</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_start_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_state">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_state</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_stop_time">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_stop_time</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_stop_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_submit_time">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_submit_time</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_submit_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CISAppServer.Jobs.set_job_state_wait_time">
<code class="descclassname">CISAppServer.Jobs.</code><code class="descname">set_job_state_wait_time</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Jobs.set_job_state_wait_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CISAppServer.Schedulers">
<span id="schedulers-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Schedulers</span></code> Module<a class="headerlink" href="#module-CISAppServer.Schedulers" title="Permalink to this headline">¶</a></h2>
<p>Module with implementations of the Scheduler interface.</p>
<dl class="exception">
<dt id="CISAppServer.Schedulers.CisError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">CisError</code><a class="headerlink" href="#CISAppServer.Schedulers.CisError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Wrong job input.</p>
</dd></dl>

<dl class="class">
<dt id="CISAppServer.Schedulers.DummyScheduler">
<em class="property">class </em><code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">DummyScheduler</code><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CISAppServer.Schedulers.Scheduler" title="CISAppServer.Schedulers.Scheduler"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Schedulers.Scheduler</span></code></a></p>
<p>Class implementing dummy scheduler. A scheduler that does not submit jubs
only lies that it did.</p>
<p>Allows for job submission, deletion and extraction of job status.</p>
<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.abort">
<code class="descname">abort</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup aborted job.</p>
<p>Removes working and output directories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.chain_input_data">
<code class="descname">chain_input_data</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.chain_input_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Chain output data of finished jobs as our input.</p>
<p>Copies output data of specified job IDs into the working directory of
current job.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance after validation</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.finalise">
<code class="descname">finalise</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.finalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare output of finished job.</p>
<p>Job working directory is moved to the external_data_path directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.generate_scripts">
<code class="descname">generate_scripts</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.generate_scripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate scripts and job input files from templates.</p>
<p>Will walk through service_data_path/service and copy all files
including recursion through subdirectories to PBS work directory for
specified job (the directory structure is retained). For all files
substitute all occurences of &#64;&#64;{atribute_name} with specified values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance after validation</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.DummyScheduler.max_jobs">
<code class="descname">max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict of maximum number of concurrent jobs per execution host</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.DummyScheduler.name">
<code class="descname">name</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler name</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.progress">
<code class="descname">progress</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the job progress log and expose it to the user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>job</em>, <em>msg</em>, <em>exit_code</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop running job and remove it from SSH queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</li>
<li><strong>msg</strong> &#8211; Message that will be passed to the user</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.submit">
<code class="descname">submit</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a job to execution host via SSH queue. The &#8220;pbs.sh&#8221; script
should be already present in the ssh_work_path/job directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.DummyScheduler.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>jobs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.DummyScheduler.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update job states to match their current state. Sets jobs state randomly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jobs</strong> &#8211; A list of Job instances for jobs to be updated.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Schedulers.PbsScheduler">
<em class="property">class </em><code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">PbsScheduler</code><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CISAppServer.Schedulers.Scheduler" title="CISAppServer.Schedulers.Scheduler"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Schedulers.Scheduler</span></code></a></p>
<p>Class implementing simple interface for PBS queue system.</p>
<p>Allows for job submission, deletion and extraction of job status.</p>
<dl class="attribute">
<dt id="CISAppServer.Schedulers.PbsScheduler.default_queue">
<code class="descname">default_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Default PBS queue</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.PbsScheduler.max_jobs">
<code class="descname">max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurent jobs</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.PbsScheduler.name">
<code class="descname">name</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.PbsScheduler.queue_path">
<code class="descname">queue_path</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.queue_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where submitted PBS job IDs are stored</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.PbsScheduler.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>job</em>, <em>msg</em>, <em>exit_code</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop running job and remove it from PBS queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</li>
<li><strong>msg</strong> &#8211; Message that will be passed to the user</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.PbsScheduler.submit">
<code class="descname">submit</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a job to PBS queue. The &#8220;pbs.sh&#8221; script should be already
present in the pbs_work_path/job directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.PbsScheduler.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>jobs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update job states to match their current state in PBS queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jobs</strong> &#8211; A list of Job instances for jobs to be updated.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.PbsScheduler.work_path">
<code class="descname">work_path</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.PbsScheduler.work_path" title="Permalink to this definition">¶</a></dt>
<dd><p>PBS Working directory path</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Schedulers.Scheduler">
<em class="property">class </em><code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">Scheduler</code><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Virtual Class implementing simple interface for execution backend. Actual
execution backends should derive from this class and implement defined
interface.</p>
<p>Allows for job submission, deletion and extraction of job status.</p>
<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.abort">
<code class="descname">abort</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup aborted job.</p>
<p>Removes working and output directories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.chain_input_data">
<code class="descname">chain_input_data</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.chain_input_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Chain output data of finished jobs as our input.</p>
<p>Copies output data of specified job IDs into the working directory of
current job.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance after validation</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.Scheduler.default_queue">
<code class="descname">default_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Default queue</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.finalise">
<code class="descname">finalise</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.finalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare output of finished job.</p>
<p>Job working directory is moved to the external_data_path directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.generate_scripts">
<code class="descname">generate_scripts</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.generate_scripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate scripts and job input files from templates.</p>
<p>Will walk through service_data_path/service and copy all files
including recursion through subdirectories to PBS work directory for
specified job (the directory structure is retained). For all files
substitute all occurences of &#64;&#64;{atribute_name} with specified values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance after validation</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.Scheduler.max_jobs">
<code class="descname">max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of concurrent jobs</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.progress">
<code class="descname">progress</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the job progress log and expose it to the user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.Scheduler.queue_path">
<code class="descname">queue_path</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.queue_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where submitted job IDs are stored</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>job</em>, <em>msg</em>, <em>exit_code</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop running job and remove it from execution queue.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.Scheduler.submit">
<code class="descname">submit</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a job for execution. The &#8220;pbs.sh&#8221; script should be already
present in the work_path/job directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.Scheduler.template_env">
<code class="descname">template_env</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.template_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Jinja2 environment configuration</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.Scheduler.work_path">
<code class="descname">work_path</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.Scheduler.work_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Working directory path</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Schedulers.SchedulerStore">
<em class="property">class </em><code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">SchedulerStore</code><a class="headerlink" href="#CISAppServer.Schedulers.SchedulerStore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<dl class="method">
<dt id="CISAppServer.Schedulers.SchedulerStore.init">
<code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.SchedulerStore.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Schedulers.SshScheduler">
<em class="property">class </em><code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">SshScheduler</code><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CISAppServer.Schedulers.Scheduler" title="CISAppServer.Schedulers.Scheduler"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Schedulers.Scheduler</span></code></a></p>
<p>Class implementing simple interface for job execution through SSH.</p>
<p>Allows for job submission, deletion and extraction of job status.</p>
<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.default_queue">
<code class="descname">default_queue</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.default_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Default SSH execute host</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.hosts">
<code class="descname">hosts</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of ssh hosts and connection objects</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.lock">
<code class="descname">lock</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Lock for SSH scheduler</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.max_jobs">
<code class="descname">max_jobs</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.max_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict of maximum number of concurrent jobs per execution host</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.name">
<code class="descname">name</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.queue_path">
<code class="descname">queue_path</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.queue_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path where submitted SSH job IDs are stored</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.SshScheduler.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>job</em>, <em>msg</em>, <em>exit_code</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop running job and remove it from SSH queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</li>
<li><strong>msg</strong> &#8211; Message that will be passed to the user</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.SshScheduler.submit">
<code class="descname">submit</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a job to execution host via SSH queue. The &#8220;pbs.sh&#8221; script
should be already present in the ssh_work_path/job directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True on success and False otherwise.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Schedulers.SshScheduler.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>jobs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update job states to match their current state on SSH execution host.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jobs</strong> &#8211; A list of Job instances for jobs to be updated.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Schedulers.SshScheduler.work_path">
<code class="descname">work_path</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Schedulers.SshScheduler.work_path" title="Permalink to this definition">¶</a></dt>
<dd><p>SSH Working directory path</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="CISAppServer.Schedulers.rmtree_error">
<code class="descclassname">CISAppServer.Schedulers.</code><code class="descname">rmtree_error</code><span class="sig-paren">(</span><em>function</em>, <em>path</em>, <em>exc_info</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Schedulers.rmtree_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception handler for shutil.rmtree().</p>
</dd></dl>

</div>
<div class="section" id="module-CISAppServer.Services">
<span id="services-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Services</span></code> Module<a class="headerlink" href="#module-CISAppServer.Services" title="Permalink to this headline">¶</a></h2>
<p>Module with implementations of the Service interface.</p>
<dl class="class">
<dt id="CISAppServer.Services.CTemplate">
<em class="property">class </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">CTemplate</code><span class="sig-paren">(</span><em>template</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.CTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">string.Template</span></code></p>
<p>Class used to substitute placeholder strings in script templates.
The placeholders have following form: &#64;&#64;{KEY}.</p>
<dl class="attribute">
<dt id="CISAppServer.Services.CTemplate.delimiter">
<code class="descname">delimiter</code><em class="property"> = '&#64;&#64;'</em><a class="headerlink" href="#CISAppServer.Services.CTemplate.delimiter" title="Permalink to this definition">¶</a></dt>
<dd><p>Delimiter identifying keywords.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.CTemplate.idpattern">
<code class="descname">idpattern</code><em class="property"> = '[_a-z0-9]+'</em><a class="headerlink" href="#CISAppServer.Services.CTemplate.idpattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.CTemplate.pattern">
<code class="descname">pattern</code><em class="property"> = &lt;_sre.SRE_Pattern object at 0x2cf2330&gt;</em><a class="headerlink" href="#CISAppServer.Services.CTemplate.pattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Services.CisError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">CisError</code><a class="headerlink" href="#CISAppServer.Services.CisError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Wrong job input.</p>
</dd></dl>

<dl class="class">
<dt id="CISAppServer.Services.Service">
<em class="property">class </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">Service</code><span class="sig-paren">(</span><em>name</em>, <em>data</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Service" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<p>Class implementing a Service.</p>
<p>Stores Service configuration and monitors its state.</p>
<p>Service C-tor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> &#8211; The name of the service.</li>
<li><strong>data</strong> &#8211; Dict with service config read from JSON data file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Other arguments are passed to dict parent class.</p>
<dl class="attribute">
<dt id="CISAppServer.Services.Service.config">
<code class="descname">config</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Service.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration options affecting service handling - like allowed
diskspace and garbage collection</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Service.name">
<code class="descname">name</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Service.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Service name</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Service.plugins">
<code class="descname">plugins</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Service.plugins" title="Permalink to this definition">¶</a></dt>
<dd><p>Definitions of validator plugins to use</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Service.sets">
<code class="descname">sets</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Service.sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Definitions of allowed variable sets</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Service.variables">
<code class="descname">variables</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Service.variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Definitions of allowed variables</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Services.ServiceStore">
<em class="property">class </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">ServiceStore</code><a class="headerlink" href="#CISAppServer.Services.ServiceStore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<dl class="method">
<dt id="CISAppServer.Services.ServiceStore.init">
<code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.ServiceStore.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="CISAppServer.Services.Validator">
<em class="property">class </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">Validator</code><a class="headerlink" href="#CISAppServer.Services.Validator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class responsible for validation of job input data.
It is also responsible for preparation of PBS scripts.</p>
<p>Initialize defaults.</p>
<dl class="attribute">
<dt id="CISAppServer.Services.Validator.api_current">
<code class="descname">api_current</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Validator.api_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Current API level</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Validator.api_max">
<code class="descname">api_max</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Validator.api_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Max API level</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Validator.api_min">
<code class="descname">api_min</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Validator.api_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Min API level</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.init">
<code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize Validator singleton.</p>
</dd></dl>

<dl class="attribute">
<dt id="CISAppServer.Services.Validator.pm">
<code class="descname">pm</code><em class="property"> = None</em><a class="headerlink" href="#CISAppServer.Services.Validator.pm" title="Permalink to this definition">¶</a></dt>
<dd><p>Current job instance
PluginManager instance</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>job</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate job input data and update <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance with
validated data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>job</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Job</span></code> instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_array">
<code class="descname">validate_array</code><span class="sig-paren">(</span><em>path</em>, <em>value</em>, <em>length</em>, <em>template</em>, <em>nesting_level=0</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate array types: string_array, int_array, float_array, datetime_array, object_array
:param path: a list of nested attribute names for logging, e.g. [object, list_attribute, 10]
:param value: value to validate
:param length: maximum allowed length of the array
:param template: template defining elements of the array
:param nesting_level: current nesting level
:return: validated array</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_chain">
<code class="descname">validate_chain</code><span class="sig-paren">(</span><em>chain</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate input chains
:param chain: list of job IDs this job depends on.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_file">
<code class="descname">validate_file</code><span class="sig-paren">(</span><em>key</em>, <em>job</em>, <em>service</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Throws:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Throws:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_file_csv">
<code class="descname">validate_file_csv</code><span class="sig-paren">(</span><em>name</em>, <em>type</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_file_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_float">
<code class="descname">validate_float</code><span class="sig-paren">(</span><em>path</em>, <em>value</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate float type
:param path: a list of nested attribute names for logging, e.g. [object, list_attribute, 10]
:param value: value to validate
:param min: minimal allowed value
:param max: maximum allowed value
:return: validated float</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_int">
<code class="descname">validate_int</code><span class="sig-paren">(</span><em>path</em>, <em>value</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate integer type
:param path: a list of nested attribute names for logging, e.g. [object, list_attribute, 10]
:param value: value to validate
:param min: minimal allowed value
:param max: maximum allowed value
:return: validated int</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_object">
<code class="descname">validate_object</code><span class="sig-paren">(</span><em>path</em>, <em>value</em>, <em>template</em>, <em>nesting_level</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate object type
:param path: a list of nested attribute names for logging, e.g. [object, list_attribute, 10]
:param value: value to validate
:param template: template defining the object structure
:param nesting_level: current nesting level
:return: validated array</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Services.Validator.validate_value">
<code class="descname">validate_value</code><span class="sig-paren">(</span><em>path</em>, <em>value</em>, <em>template</em>, <em>nesting_level=0</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.Validator.validate_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate value for specified service attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> &#8211; a list of nested attribute names for logging, e.g. [object, list_attribute, 10]</li>
<li><strong>value</strong> &#8211; value to validate</li>
<li><strong>template</strong> &#8211; dictionary describing the variable</li>
<li><strong>nesting_level</strong> &#8211; current nesting level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">validated variable</p>
</td>
</tr>
</tbody>
</table>
<p>The parameter <strong>value</strong> should be of the following form:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;float_array&#39;</span><span class="p">,</span>
    <span class="s">&#39;default&#39;</span><span class="p">:[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
    <span class="s">&#39;values&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span>
    <span class="s">&#39;length&#39;</span><span class="p">:</span><span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
<ul>
<li><dl class="first docutils">
<dt>Allowed &#8216;type&#8217;s:</dt>
<dd><ul class="first last simple">
<li>string</li>
<li>int</li>
<li>float</li>
<li>datetime</li>
<li>object</li>
<li>string_array</li>
<li>int_array</li>
<li>float_array</li>
<li>datetime_array</li>
<li>object_array</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">&#8216;default&#8217; should be of an appropriate type.</p>
</li>
<li><dl class="first docutils">
<dt>&#8216;values&#8217; defines allowed value of the variable:</dt>
<dd><ul class="first last simple">
<li>string - white list of strings</li>
<li>int, float - [min. max]</li>
<li>datetime - strptime format string</li>
<li>object - dictionary with keys being attribute names and values dictionaries defining variable templates</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">&#8216;length&#8217; is only mandatory for array types and defines maximum allowed length</p>
</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Services.ValidatorError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">ValidatorError</code><a class="headerlink" href="#CISAppServer.Services.ValidatorError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Wrong job input.</p>
</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Services.ValidatorInputFileError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Services.</code><code class="descname">ValidatorInputFileError</code><a class="headerlink" href="#CISAppServer.Services.ValidatorInputFileError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Wrong job state exception.</p>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.Services.rmtree_error">
<code class="descclassname">CISAppServer.Services.</code><code class="descname">rmtree_error</code><span class="sig-paren">(</span><em>function</em>, <em>path</em>, <em>exc_info</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Services.rmtree_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception handler for shutil.rmtree().</p>
</dd></dl>

</div>
<div class="section" id="module-CISAppServer.Tools">
<span id="tools-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Tools</span></code> Module<a class="headerlink" href="#module-CISAppServer.Tools" title="Permalink to this headline">¶</a></h2>
<p>Utility classes used by CISAppServer.</p>
<dl class="function">
<dt id="CISAppServer.Tools.rollback">
<code class="descclassname">CISAppServer.Tools.</code><code class="descname">rollback</code><span class="sig-paren">(</span><em>exception_to_check</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Tools.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Rollback decorator for StateManager DB calls</p>
<p>param: exception_to_check - Exception class or list of classes for which rollback will be issued</p>
</dd></dl>

</div>
<div class="section" id="module-CISAppServer.Daemon">
<span id="daemon-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">Daemon</span></code> Module<a class="headerlink" href="#module-CISAppServer.Daemon" title="Permalink to this headline">¶</a></h2>
<p>Implementation of daemon mode for CISAppServer.</p>
<dl class="class">
<dt id="CISAppServer.Daemon.DaemonRunner">
<em class="property">class </em><code class="descclassname">CISAppServer.Daemon.</code><code class="descname">DaemonRunner</code><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Controller for JobManager instance running in a separate background
process.</p>
<p>The command-line argument is the action to take:</p>
<ul>
<li><p class="first">&#8216;start&#8217;: Become a daemon and call <cite>app.run()</cite>.</p>
</li>
<li><p class="first">&#8216;stop&#8217;: Exit the daemon process specified in the PID file.</p>
</li>
<li><dl class="first docutils">
<dt>&#8216;terminate&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">Exit the daemon process specified in the PID file, kill all</span></dt>
<dd><p class="first last">active jobs</p>
</dd>
</dl>
</li>
<li><p class="first">&#8216;restart&#8217;: Stop, then start.</p>
</li>
<li><p class="first">&#8216;reload&#8217;: Reread the configuration file.</p>
</li>
<li><p class="first">&#8216;pause&#8217; : Stop the job queue</p>
</li>
<li><p class="first">&#8216;run&#8217; : Restart the job queue</p>
</li>
<li><p class="first">&#8216;status&#8217; : Check status of the server</p>
</li>
</ul>
<p>Upon initialization parses command line arguments, loads options
from input files. Initializes Validator and Sheduler interfaces.</p>
<dl class="attribute">
<dt id="CISAppServer.Daemon.DaemonRunner.action_funcs">
<code class="descname">action_funcs</code><em class="property"> = {u'status': &lt;function _status at 0x387bf50&gt;, u'start': &lt;function _start at 0x387baa0&gt;, u'pause': &lt;function _pause at 0x387be60&gt;, u'run': &lt;function _run at 0x387bed8&gt;, u'reload': &lt;function _reload at 0x387bde8&gt;, u'terminate': &lt;function _terminate at 0x387bcf8&gt;, u'stop': &lt;function _stop at 0x387bc80&gt;, u'restart': &lt;function _restart at 0x387bd70&gt;}</em><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.action_funcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><em>signum</em>, <em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.cleanup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.parse_args">
<code class="descname">parse_args</code><span class="sig-paren">(</span><em>argv=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.parse_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command-line arguments.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.pause">
<code class="descname">pause</code><span class="sig-paren">(</span><em>signum</em>, <em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.pause" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.reload_config">
<code class="descname">reload_config</code><span class="sig-paren">(</span><em>signum</em>, <em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.reload_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the requested action.</p>
</dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>signum</em>, <em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="CISAppServer.Daemon.DaemonRunner.unpause">
<code class="descname">unpause</code><span class="sig-paren">(</span><em>signum</em>, <em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunner.unpause" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Daemon.DaemonRunnerError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Daemon.</code><code class="descname">DaemonRunnerError</code><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunnerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Abstract base class for errors from DaemonRunner.</p>
</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Daemon.DaemonRunnerInvalidActionError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Daemon.</code><code class="descname">DaemonRunnerInvalidActionError</code><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunnerInvalidActionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.ValueError</span></code>, <a class="reference internal" href="#CISAppServer.Daemon.DaemonRunnerError" title="CISAppServer.Daemon.DaemonRunnerError"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Daemon.DaemonRunnerError</span></code></a></p>
<p>Raised when specified action for DaemonRunner is invalid.</p>
</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Daemon.DaemonRunnerReloadFailureError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Daemon.</code><code class="descname">DaemonRunnerReloadFailureError</code><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunnerReloadFailureError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.RuntimeError</span></code>, <a class="reference internal" href="#CISAppServer.Daemon.DaemonRunnerError" title="CISAppServer.Daemon.DaemonRunnerError"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Daemon.DaemonRunnerError</span></code></a></p>
<p>Raised when failure reloading DaemonRunner.</p>
</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Daemon.DaemonRunnerStartFailureError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Daemon.</code><code class="descname">DaemonRunnerStartFailureError</code><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunnerStartFailureError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.RuntimeError</span></code>, <a class="reference internal" href="#CISAppServer.Daemon.DaemonRunnerError" title="CISAppServer.Daemon.DaemonRunnerError"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Daemon.DaemonRunnerError</span></code></a></p>
<p>Raised when failure starting DaemonRunner.</p>
</dd></dl>

<dl class="exception">
<dt id="CISAppServer.Daemon.DaemonRunnerStopFailureError">
<em class="property">exception </em><code class="descclassname">CISAppServer.Daemon.</code><code class="descname">DaemonRunnerStopFailureError</code><a class="headerlink" href="#CISAppServer.Daemon.DaemonRunnerStopFailureError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.RuntimeError</span></code>, <a class="reference internal" href="#CISAppServer.Daemon.DaemonRunnerError" title="CISAppServer.Daemon.DaemonRunnerError"><code class="xref py py-class docutils literal"><span class="pre">CISAppServer.Daemon.DaemonRunnerError</span></code></a></p>
<p>Raised when failure stopping DaemonRunner.</p>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.Daemon.is_pidfile_stale">
<code class="descclassname">CISAppServer.Daemon.</code><code class="descname">is_pidfile_stale</code><span class="sig-paren">(</span><em>pidfile</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.is_pidfile_stale" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether a PID file is stale.</p>
<p>Return <code class="docutils literal"><span class="pre">True</span></code> (“stale”) if the contents of the PID file are
valid but do not match the PID of a currently-running process;
otherwise return <code class="docutils literal"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="CISAppServer.Daemon.make_pidlockfile">
<code class="descclassname">CISAppServer.Daemon.</code><code class="descname">make_pidlockfile</code><span class="sig-paren">(</span><em>path</em>, <em>acquire_timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#CISAppServer.Daemon.make_pidlockfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a PIDLockFile instance with the given filesystem path.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CISAppGateway.html" title="CISAppGateway Package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CIŚ Web Services 0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Implementation reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, CIŚ.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>